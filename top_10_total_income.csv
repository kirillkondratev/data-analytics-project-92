with tab as (
select sales_id,
	   concat(e.first_name||' '||e.last_name) as name1,
	   quantity,
	   p.price,
	   quantity*price as sale_amount,
	   sale_date,
	   s.product_id,
	   p.name
from sales as s
	left join products as p 
	on s.product_id = p.product_id
	left join employees as e 
	on s.sales_person_id = e.employee_id
order by sales_person_id)

select name1 as name,
	   count(sales_id) as operations,
	   sum(sale_amount) as income
from tab
group by name1
order by income desc
limit 10;
